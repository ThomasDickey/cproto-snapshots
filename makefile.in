# $Id: makefile.in,v 3.9 1994/07/31 16:31:56 tom Exp $
#
# UNIX template-makefile for C prototype generator

CC		= @CC@
CPP		= @CPP@
LEX		= @LEX@
YACC		= @YACC@
LINT		= @LINT@

INSTALL		= @INSTALL@
INSTALL_PROGRAM	= @INSTALL_PROGRAM@
INSTALL_DATA	= @INSTALL_DATA@

DEFINES		=
CPP_OPTS	= $(DEFINES) -DHAVE_CONFIG_H
CFLAGS		= @CC_OPTS@ $(CPP_OPTS)
LIBS		= @LIBS@ @LEXLIB@

DOC_FILES = \
	README \
	CHANGES \
	cproto.man \
	cproto.1

MAK_FILES = \
	makefile.in \
	configure.in

H_FILES = \
	system.h \
	cproto.h \
	patchlev.h \
	semantic.h \
	symbol.h

C_FILES = \
	cproto.c \
	lintlibs.c \
	semantic.c \
	strkey.c \
	strstr.c \
	symbol.c

AUX_FILES = \
	lex.l \
	grammar.y

JUNK =	\
	lex.yy.c \
	y.tab.c

OBJECTS = cproto.o lintlibs.o semantic.o strkey.o strstr.o symbol.o y.tab.o

all : cproto cproto.man

cproto : $(OBJECTS)
	$(CC) $(CFLAGS) -o $@ $(OBJECTS) $(LIBS)

y.tab.c : grammar.y
	$(YACC) grammar.y

lex.yy.c : lex.l
	$(LEX) lex.l

cproto.man : cproto.1
	nroff -man cproto.1 >$@

clean :
	rm -f *.o *.bak *.log *.man *.out $(JUNK) tags

clobber : clean
	rm -f cproto

distclean : clobber
	rm -f stamp-h config.status config.h makefile

# configure might not change config.h
config.h : stamp-h
stamp-h : config.status
	./config.status
	touch stamp-h

makefile: makefile.in config.status
	./config.status

config.status : configure
	./config.status --recheck

configure : configure.in
	autoconf

shar: $(DOC_FILES) $(MAK_FILES) $(H_FILES) $(C_FILES) $(AUX_FILES)
	shar -opart -l50 $(DOC_FILES) $(MAK_FILES) $(H_FILES) $(C_FILES) $(AUX_FILES)

default.h: $(C_FILES)
	./cproto -e -v -m -M ARGS $(DEFINES) $(C_FILES) grammar.y >$@

lint: $(C_FILES)
	$(LINT) $(CPP_OPTS) -lyacc $(C_FILES) y.tab.c >$@.out

llib: $(C_FILES)
	./cproto -l $(CPP_OPTS) $(C_FILES) y.tab.c >$@.out

tags: $(H_FILES) $(C_FILES) $(AUX_FILES)
	ctags -t $(C_FILES) $(AUX_FILES) $(H_FILES)

depend:
	makedepend -- $(CFLAGS) -- $(C_FILES) y.tab.c

# DO NOT DELETE THIS LINE -- make depend depends on it.

cproto.o: cproto.h config.h system.h patchlev.h
lintlibs.o: cproto.h config.h system.h semantic.h symbol.h
semantic.o: cproto.h config.h system.h semantic.h
strkey.o: cproto.h config.h system.h 
strstr.o: config.h
symbol.o: cproto.h config.h system.h symbol.h
y.tab.o: cproto.h config.h system.h symbol.h semantic.h lex.yy.c
